/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
*/
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ObsidianRewardHubPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");

const DEFAULT_SETTINGS = {
  currentXP: 0,
  currentLevel: 1,
  showNotifications: true,
  customLevelMessages: {},
  customLevelImages: {},
  specialDates: [
    {
      id: "new-year",
      date: "01-01",
      message: "ChÃºc má»«ng nÄƒm má»›i! HÃ£y tiáº¿p tá»¥c hÃ nh trÃ¬nh ghi chÃº! ğŸŠ",
      imagePath: "",
      enabled: true
    },
    {
      id: "valentine",
      date: "02-14",
      message: "Happy Valentine's Day! TÃ¬nh yÃªu vá»›i viá»‡c ghi chÃº! â¤ï¸",
      imagePath: "",
      enabled: true
    },
    {
      id: "womens-day",
      date: "03-08",
      message: "ChÃºc má»«ng ngÃ y Quá»‘c táº¿ Phá»¥ ná»¯! ğŸŒ¸",
      imagePath: "",
      enabled: true
    },
    {
      id: "independence-day",
      date: "09-02",
      message: "ChÃºc má»«ng Quá»‘c khÃ¡nh Viá»‡t Nam! ğŸ‡»ğŸ‡³",
      imagePath: "",
      enabled: true
    },
    {
      id: "christmas",
      date: "12-25",
      message: "Merry Christmas! GiÃ¡ng sinh an lÃ nh! ğŸ„ğŸ…",
      imagePath: "",
      enabled: true
    }
  ],
  debugNotifications: [
    {
      id: "test-1",
      name: "Test Birthday",
      message: "ChÃºc má»«ng sinh nháº­t! ğŸ‚ğŸ‰",
      imagePath: ""
    },
    {
      id: "test-2",
      name: "Test Achievement",
      message: "Báº¡n Ä‘Ã£ hoÃ n thÃ nh thÃ nh tá»±u! ğŸ†âœ¨",
      imagePath: ""
    }
  ],
  lastActiveDate: "",
  dailyXPMultiplier: 1,
  reviewXPMultiplier: 2
};

class ObsidianRewardHubPlugin extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.fileModificationTimes = /* @__PURE__ */ new Map();
  }
  async onload() {
    try {
      await this.loadSettings();
      this.statusBarItem = this.addStatusBarItem();
      this.updateStatusBar();
      this.registerEvent(
        this.app.vault.on("modify", this.onFileModify.bind(this))
      );
      this.registerEvent(
        this.app.workspace.on("file-open", this.onFileOpen.bind(this))
      );
      setTimeout(() => {
        this.checkSpecialDates();
      }, 1e3);
      this.addSettingTab(new RewardHubSettingTab(this.app, this));
      this.addCommand({
        id: "show-reward-info",
        name: "Show Reward Hub Information",
        callback: () => {
          new RewardInfoModal(this.app, this).open();
        }
      });
      this.addCommand({
        id: "add-bonus-xp",
        name: "Add Bonus XP",
        callback: () => {
          new BonusXPModal(this.app, this).open();
        }
      });
      this.addCommand({
        id: "debug-notifications",
        name: "Debug/Test Notifications",
        callback: () => {
          new DebugNotificationModal(this.app, this).open();
        }
      });
      if (this.settings.currentXP === 0) {
        setTimeout(() => {
          new WelcomeModal(this.app).open();
        }, 2e3);
      }
      console.log("Obsidian Reward Hub Plugin loaded successfully!");
    } catch (error) {
      console.error("Error loading Obsidian Reward Hub Plugin:", error);
      new import_obsidian.Notice("Lá»—i khi táº£i Reward Hub Plugin: " + error.message);
    }
  }
  onunload() {
    console.log("Obsidian Reward Hub Plugin unloaded");
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    if (!this.settings.debugNotifications) {
      this.settings.debugNotifications = DEFAULT_SETTINGS.debugNotifications;
    }
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.updateStatusBar();
  }
  calculateLevelFromXP(xp) {
    return Math.floor(Math.sqrt(xp / 100)) + 1;
  }
  calculateXPForLevel(level) {
    return Math.pow(level - 1, 2) * 100;
  }
  calculateXPForNextLevel(currentLevel) {
    return this.calculateXPForLevel(currentLevel + 1);
  }
  addXP(amount, reason = "") {
    const oldLevel = this.settings.currentLevel;
    this.settings.currentXP += amount;
    this.settings.currentLevel = this.calculateLevelFromXP(this.settings.currentXP);
    if (this.settings.currentLevel > oldLevel) {
      this.onLevelUp(oldLevel, this.settings.currentLevel);
    }
    this.saveSettings();
    if (reason) {
      new import_obsidian.Notice(`ğŸ +${amount} XP: ${reason}`, 3e3);
    }
  }
  onLevelUp(oldLevel, newLevel) {
    const isRoundLevel = newLevel % 10 === 0 || newLevel % 100 === 0;
    if (isRoundLevel && this.settings.showNotifications) {
      const customMessage = this.settings.customLevelMessages[newLevel];
      const customImage = this.settings.customLevelImages[newLevel];
      new LevelUpModal(
        this.app,
        newLevel,
        customMessage || `ğŸ‰ ChÃºc má»«ng! Báº¡n Ä‘Ã£ Ä‘áº¡t Level ${newLevel} trong Reward Hub! ğŸ†`,
        customImage
      ).open();
    } else {
      new import_obsidian.Notice(`ğŸŒŸ Level Up! Báº¡n Ä‘Ã£ Ä‘áº¡t Level ${newLevel}! ğŸš€`, 5e3);
    }
  }
  async onFileModify(file) {
    try {
      if (file.extension !== "md") return;
      const currentTime = Date.now();
      const lastModified = this.fileModificationTimes.get(file.path) || 0;
      const timeDiff = currentTime - lastModified;
      if (timeDiff < 5e3) {
        this.addXP(1, "Ghi chÃº");
      } else {
        const isOldNote = this.isOldNote(file);
        if (isOldNote) {
          this.addXP(Math.floor(5 * this.settings.reviewXPMultiplier), "Review ghi chÃº cÅ©");
        } else {
          this.addXP(2, "Chá»‰nh sá»­a ghi chÃº");
        }
      }
      this.fileModificationTimes.set(file.path, currentTime);
    } catch (error) {
      console.error("Error in onFileModify:", error);
    }
  }
  async onFileOpen(file) {
    try {
      if (!file || file.extension !== "md") return;
      const isOldNote = this.isOldNote(file);
      if (isOldNote) {
        this.addXP(Math.floor(3 * this.settings.reviewXPMultiplier), "Xem láº¡i ghi chÃº cÅ©");
      }
    } catch (error) {
      console.error("Error in onFileOpen:", error);
    }
  }
  isOldNote(file) {
    const now = Date.now();
    const fileAge = now - file.stat.ctime;
    const sevenDaysInMs = 7 * 24 * 60 * 60 * 1e3;
    return fileAge > sevenDaysInMs;
  }
  updateStatusBar() {
    try {
      const currentXP = this.settings.currentXP;
      const currentLevel = this.settings.currentLevel;
      const nextLevelXP = this.calculateXPForNextLevel(currentLevel);
      const currentLevelXP = this.calculateXPForLevel(currentLevel);
      const progress = currentXP - currentLevelXP;
      const needed = nextLevelXP - currentLevelXP;
      const percentage = Math.round(progress / needed * 100);
      this.statusBarItem.setText(
        `ğŸ® Reward Hub | Lv.${currentLevel} | ${progress}/${needed} XP (${percentage}%)`
      );
      this.statusBarItem.title = `Obsidian Reward Hub
Total XP: ${currentXP}
Next Level: ${nextLevelXP - currentXP} XP needed`;
    } catch (error) {
      console.error("Error updating status bar:", error);
    }
  }
  checkSpecialDates() {
    try {
      const today = /* @__PURE__ */ new Date();
      const todayString = `${(today.getMonth() + 1).toString().padStart(2, "0")}-${today.getDate().toString().padStart(2, "0")}`;
      this.settings.specialDates.forEach((specialDate) => {
        if (specialDate.enabled && specialDate.date === todayString) {
          setTimeout(() => {
            new SpecialDateModal(
              this.app,
              specialDate.message,
              specialDate.imagePath
            ).open();
          }, 3e3);
        }
      });
    } catch (error) {
      console.error("Error checking special dates:", error);
    }
  }
  showTestNotification(message, imagePath) {
    new SpecialDateModal(this.app, message, imagePath).open();
  }
}

class DebugNotificationModal extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    this.plugin = plugin;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "ğŸ”§ Debug/Test Notifications" });
    const quickTestContainer = contentEl.createDiv({ cls: "debug-section" });
    quickTestContainer.createEl("h3", { text: "âš¡ Quick Tests" });
    new import_obsidian.Setting(quickTestContainer).setName("Test Level Up").setDesc("Test level up notification").addButton((btn) => btn.setButtonText("ğŸ‰ Test Level Up").onClick(() => {
      new LevelUpModal(
        this.app,
        50,
        "Test Level Up Message! ğŸŠ",
        ""
      ).open();
    }));
    new import_obsidian.Setting(quickTestContainer).setName("Test Special Date").setDesc("Test special date notification").addButton((btn) => btn.setButtonText("ğŸŠ Test Special Date").onClick(() => {
      new SpecialDateModal(
        this.app,
        "Test Special Date Message! ğŸˆ",
        ""
      ).open();
    }));
    const debugContainer = contentEl.createDiv({ cls: "debug-section" });
    debugContainer.createEl("h3", { text: "ğŸ› ï¸ Custom Debug Notifications" });
    this.plugin.settings.debugNotifications.forEach((debug, index) => {
      new import_obsidian.Setting(debugContainer).setName(`ğŸ§ª ${debug.name}`).setDesc(debug.message.substring(0, 40) + "...").addButton((btn) => btn.setButtonText("ğŸ“ Edit").onClick(() => {
        new DebugEditModal(this.app, this.plugin, debug, () => {
          this.display();
        }).open();
      })).addButton((btn) => btn.setButtonText("ğŸš€ Test").setCta().onClick(() => {
        this.plugin.showTestNotification(debug.message, debug.imagePath);
      })).addButton((btn) => btn.setButtonText("ğŸ—‘ï¸ Delete").setWarning().onClick(async () => {
        this.plugin.settings.debugNotifications.splice(index, 1);
        await this.plugin.saveSettings();
        new import_obsidian.Notice("ÄÃ£ xÃ³a debug notification");
        this.display();
      }));
    });
    new import_obsidian.Setting(debugContainer).addButton((btn) => btn.setButtonText("â• Add Debug Notification").onClick(() => {
      const newDebug = {
        id: Date.now().toString(),
        name: "New Test",
        message: "Test message",
        imagePath: ""
      };
      new DebugEditModal(this.app, this.plugin, newDebug, () => {
        this.display();
      }, true).open();
    }));
    const closeButton = contentEl.createEl("button", { text: "Close", cls: "mod-cta" });
    closeButton.style.marginTop = "20px";
    closeButton.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  display() {
    this.onOpen();
  }
}

class DebugEditModal extends import_obsidian.Modal {
  constructor(app, plugin, debug, onSave, isNew = false) {
    super(app);
    this.plugin = plugin;
    this.debug = debug;
    this.onSave = onSave;
    this.isNew = isNew;
    this.name = debug.name;
    this.message = debug.message;
    this.imagePath = debug.imagePath;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: this.isNew ? "â• Add Debug Notification" : "âœï¸ Edit Debug Notification" });
    new import_obsidian.Setting(contentEl).setName("TÃªn").setDesc("TÃªn Ä‘á»ƒ nháº­n diá»‡n debug notification").addText((text) => text.setValue(this.name).onChange((value) => {
      this.name = value;
    }));
    new import_obsidian.Setting(contentEl).setName("Message").setDesc("Ná»™i dung thÃ´ng bÃ¡o test").addTextArea((text) => {
      text.setValue(this.message);
      text.inputEl.rows = 4;
      text.onChange((value) => {
        this.message = value;
      });
    });
    new import_obsidian.Setting(contentEl).setName("ÄÆ°á»ng dáº«n hÃ¬nh áº£nh").setDesc("ÄÆ°á»ng dáº«n Ä‘áº¿n file hÃ¬nh áº£nh (tÃ¹y chá»n)").addText((text) => text.setPlaceholder("https://example.com/image.jpg hoáº·c local/path/image.png").setValue(this.imagePath).onChange((value) => {
      this.imagePath = value;
    }));
    new import_obsidian.Setting(contentEl).setName("Test Preview").setDesc("Xem trÆ°á»›c thÃ´ng bÃ¡o vá»›i ná»™i dung hiá»‡n táº¡i").addButton((btn) => btn.setButtonText("ğŸ” Preview").onClick(() => {
      this.plugin.showTestNotification(this.message, this.imagePath);
    }));
    const buttonContainer = contentEl.createDiv({ cls: "debug-buttons" });
    buttonContainer.style.marginTop = "20px";
    buttonContainer.style.display = "flex";
    buttonContainer.style.gap = "10px";
    buttonContainer.style.justifyContent = "center";
    const saveBtn = buttonContainer.createEl("button", { text: "ğŸ’¾ Save", cls: "mod-cta" });
    saveBtn.addEventListener("click", async () => {
      if (!this.name.trim()) {
        new import_obsidian.Notice("Vui lÃ²ng nháº­p tÃªn!");
        return;
      }
      if (!this.message.trim()) {
        new import_obsidian.Notice("Vui lÃ²ng nháº­p message!");
        return;
      }
      const updatedDebug = {
        id: this.debug.id,
        name: this.name,
        message: this.message,
        imagePath: this.imagePath
      };
      if (this.isNew) {
        this.plugin.settings.debugNotifications.push(updatedDebug);
      } else {
        const index = this.plugin.settings.debugNotifications.findIndex((d) => d.id === this.debug.id);
        if (index !== -1) {
          this.plugin.settings.debugNotifications[index] = updatedDebug;
        }
      }
      await this.plugin.saveSettings();
      new import_obsidian.Notice(this.isNew ? "ÄÃ£ thÃªm debug notification!" : "ÄÃ£ cáº­p nháº­t debug notification!");
      this.onSave();
      this.close();
    });
    const cancelBtn = buttonContainer.createEl("button", { text: "âŒ Cancel" });
    cancelBtn.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}

class WelcomeModal extends import_obsidian.Modal {
  constructor(app) {
    super(app);
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("reward-hub-modal");
    const header = contentEl.createEl("div", { cls: "welcome-header" });
    header.createEl("h1", { text: "ğŸ‰ ChÃ o má»«ng Ä‘áº¿n vá»›i Reward Hub! ğŸ‰", cls: "welcome-title" });
    const content = contentEl.createDiv({ cls: "welcome-content" });
    content.innerHTML = `
            <div class="welcome-info">
                <h3>ğŸ® Há»‡ thá»‘ng Gamification cho Obsidian</h3>
                <p>Reward Hub sáº½ biáº¿n viá»‡c ghi chÃº thÃ nh má»™t tráº£i nghiá»‡m thÃº vá»‹ vá»›i:</p>
                <ul>
                    <li>ğŸ† <strong>Há»‡ thá»‘ng Level:</strong> TÄƒng level khi tÃ­ch lÅ©y XP</li>
                    <li>â­ <strong>Kiáº¿m XP:</strong> Má»—i hoáº¡t Ä‘á»™ng ghi chÃº Ä‘á»u Ä‘Æ°á»£c thÆ°á»Ÿng</li>
                    <li>ğŸ <strong>Review Bonus:</strong> Äiá»ƒm thÆ°á»Ÿng cao khi xem láº¡i ghi chÃº cÅ©</li>
                    <li>ğŸŠ <strong>NgÃ y Äáº·c Biá»‡t:</strong> ThÃ´ng bÃ¡o tá»± Ä‘á»™ng cho cÃ¡c ngÃ y quan trá»ng</li>
                    <li>ğŸ… <strong>ThÃ nh Tá»±u:</strong> ThÃ´ng bÃ¡o Ä‘áº·c biá»‡t cho level milestone</li>
                </ul>
                
                <div class="xp-guide">
                    <h4>ğŸ’¡ CÃ¡ch kiáº¿m XP:</h4>
                    <ul>
                        <li>GÃµ kÃ½ tá»±: <span class="xp-value">+1 XP</span></li>
                        <li>Chá»‰nh sá»­a ghi chÃº: <span class="xp-value">+2 XP</span></li>
                        <li>Xem ghi chÃº cÅ©: <span class="xp-value">+6 XP</span></li>
                        <li>Sá»­a ghi chÃº cÅ©: <span class="xp-value">+10 XP</span></li>
                    </ul>
                </div>
                
                <p class="welcome-footer">
                    <strong>Báº¯t Ä‘áº§u viáº¿t Ä‘á»ƒ kiáº¿m XP Ä‘áº§u tiÃªn! ğŸš€</strong>
                </p>
            </div>
        `;
    const button = contentEl.createEl("button", { text: "Báº¯t Ä‘áº§u hÃ nh trÃ¬nh! ğŸ¯", cls: "mod-cta welcome-button" });
    button.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}

class LevelUpModal extends import_obsidian.Modal {
  constructor(app, level, message, imagePath) {
    super(app);
    this.level = level;
    this.message = message;
    this.imagePath = imagePath;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("reward-hub-modal");
    const header = contentEl.createEl("div", { cls: "level-up-header" });
    header.createEl("h1", { text: "ğŸ‰ REWARD HUB LEVEL UP! ğŸ‰", cls: "level-up-title" });
    header.createEl("h2", { text: `Level ${this.level}`, cls: "level-number" });
    if (this.imagePath && this.imagePath.trim()) {
      const imgContainer = contentEl.createEl("div", { cls: "level-image-container" });
      const img = imgContainer.createEl("img", { cls: "level-image" });
      img.src = this.imagePath;
      img.style.maxWidth = "300px";
      img.style.maxHeight = "300px";
      img.style.display = "block";
      img.style.margin = "20px auto";
      img.style.borderRadius = "10px";
      img.style.boxShadow = "0 4px 15px rgba(0,0,0,0.3)";
    }
    const messageEl = contentEl.createEl("p", { text: this.message, cls: "level-message" });
    messageEl.style.fontSize = "1.2em";
    messageEl.style.margin = "20px 0";
    const buttonContainer = contentEl.createEl("div", { cls: "level-button-container" });
    const button = buttonContainer.createEl("button", { text: "Awesome! ğŸš€", cls: "mod-cta" });
    button.style.fontSize = "1.1em";
    button.style.padding = "10px 20px";
    button.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}

class SpecialDateModal extends import_obsidian.Modal {
  constructor(app, message, imagePath) {
    super(app);
    this.message = message;
    this.imagePath = imagePath;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("reward-hub-modal");
    const header = contentEl.createEl("div", { cls: "special-date-header" });
    header.createEl("h1", { text: "ğŸŠ Reward Hub - NgÃ y Äáº·c Biá»‡t! ğŸŠ", cls: "special-date-title" });
    if (this.imagePath && this.imagePath.trim()) {
      const imgContainer = contentEl.createEl("div", { cls: "special-image-container" });
      const img = imgContainer.createEl("img", { cls: "special-image" });
      img.src = this.imagePath;
      img.style.maxWidth = "300px";
      img.style.maxHeight = "300px";
      img.style.display = "block";
      img.style.margin = "20px auto";
      img.style.borderRadius = "10px";
      img.style.boxShadow = "0 4px 15px rgba(0,0,0,0.3)";
    }
    const messageEl = contentEl.createEl("p", { text: this.message, cls: "special-message" });
    messageEl.style.fontSize = "1.2em";
    messageEl.style.margin = "20px 0";
    messageEl.style.textAlign = "center";
    const buttonContainer = contentEl.createEl("div", { cls: "special-button-container" });
    const button = buttonContainer.createEl("button", { text: "Cáº£m Æ¡n Reward Hub! ğŸ’–", cls: "mod-cta" });
    button.style.fontSize = "1.1em";
    button.style.padding = "10px 20px";
    button.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}

class RewardInfoModal extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    this.plugin = plugin;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "ğŸ“Š Obsidian Reward Hub - ThÃ´ng Tin Level" });
    const currentXP = this.plugin.settings.currentXP;
    const currentLevel = this.plugin.settings.currentLevel;
    const nextLevelXP = this.plugin.calculateXPForNextLevel(currentLevel);
    const currentLevelXP = this.plugin.calculateXPForLevel(currentLevel);
    const progressXP = currentXP - currentLevelXP;
    const neededXP = nextLevelXP - currentLevelXP;
    const progressPercent = Math.round(progressXP / neededXP * 100);
    const stats = contentEl.createDiv({ cls: "reward-stats" });
    stats.innerHTML = `
            <div class="stat-item">
                <span class="stat-label">ğŸ† Level hiá»‡n táº¡i:</span>
                <span class="stat-value">${currentLevel}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">â­ Tá»•ng XP:</span>
                <span class="stat-value">${currentXP}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">ğŸ¯ XP Ä‘áº¿n level tiáº¿p:</span>
                <span class="stat-value">${nextLevelXP - currentXP}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">ğŸ“ˆ Tiáº¿n Ä‘á»™:</span>
                <span class="stat-value">${progressXP}/${neededXP} (${progressPercent}%)</span>
            </div>
        `;
    const progressContainer = contentEl.createDiv({ cls: "progress-container" });
    progressContainer.innerHTML = `
            <div class="progress-bar">
                <div class="progress-fill" style="width: ${progressPercent}%"></div>
            </div>
        `;
    const tips = contentEl.createDiv({ cls: "reward-tips" });
    tips.innerHTML = `
            <h3>ğŸ’¡ CÃ¡ch kiáº¿m XP trong Reward Hub:</h3>
            <ul>
                <li>âœï¸ GÃµ kÃ½ tá»± liÃªn tá»¥c: <strong>+1 XP</strong></li>
                <li>ğŸ“ Chá»‰nh sá»­a ghi chÃº: <strong>+2 XP</strong></li>
                <li>ğŸ‘€ Xem ghi chÃº cÅ© (>7 ngÃ y): <strong>+${Math.floor(3 * this.plugin.settings.reviewXPMultiplier)} XP</strong></li>
                <li>ğŸ”„ Review/sá»­a ghi chÃº cÅ©: <strong>+${Math.floor(5 * this.plugin.settings.reviewXPMultiplier)} XP</strong></li>
            </ul>
            <p class="tip-highlight">ğŸ’ <strong>Máº¹o:</strong> ThÆ°á»ng xuyÃªn xem láº¡i vÃ  cáº­p nháº­t ghi chÃº cÅ© Ä‘á»ƒ kiáº¿m nhiá»u XP hÆ¡n!</p>
        `;
    const button = contentEl.createEl("button", { text: "ÄÃ³ng", cls: "mod-cta" });
    button.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}

class BonusXPModal extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    this.bonusAmount = 10;
    this.plugin = plugin;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "ğŸ Reward Hub - ThÃªm Bonus XP" });
    new import_obsidian.Setting(contentEl).setName("Sá»‘ lÆ°á»£ng XP").setDesc("Nháº­p sá»‘ XP muá»‘n thÃªm (cho debug hoáº·c thÆ°á»Ÿng Ä‘áº·c biá»‡t)").addText((text) => text.setValue(this.bonusAmount.toString()).onChange((value) => {
      this.bonusAmount = parseInt(value) || 10;
    }));
    const buttonContainer = contentEl.createDiv({ cls: "button-container" });
    buttonContainer.style.marginTop = "20px";
    buttonContainer.style.display = "flex";
    buttonContainer.style.gap = "10px";
    buttonContainer.style.justifyContent = "center";
    const addBtn = buttonContainer.createEl("button", { text: "ThÃªm XP", cls: "mod-cta" });
    addBtn.addEventListener("click", () => {
      this.plugin.addXP(this.bonusAmount, "Bonus XP tá»« Reward Hub");
      this.close();
    });
    const cancelBtn = buttonContainer.createEl("button", { text: "Há»§y" });
    cancelBtn.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}

class RewardHubSettingTab extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "âš™ï¸ Obsidian Reward Hub - CÃ i Äáº·t" });
    const currentXP = this.plugin.settings.currentXP;
    const currentLevel = this.plugin.settings.currentLevel;
    const nextLevelXP = this.plugin.calculateXPForNextLevel(currentLevel);
    const progressPercent = Math.round((currentXP - this.plugin.calculateXPForLevel(currentLevel)) / (nextLevelXP - this.plugin.calculateXPForLevel(currentLevel)) * 100);
    new import_obsidian.Setting(containerEl).setName("ğŸ® Tráº¡ng ThÃ¡i Reward Hub").setDesc(`Level: ${currentLevel} | Total XP: ${currentXP} | Tiáº¿n Ä‘á»™: ${progressPercent}%`).addButton((btn) => btn.setButtonText("ğŸ”„ Reset Progress").setWarning().onClick(async () => {
      this.plugin.settings.currentXP = 0;
      this.plugin.settings.currentLevel = 1;
      await this.plugin.saveSettings();
      new import_obsidian.Notice("ÄÃ£ reset tiáº¿n Ä‘á»™ Reward Hub!");
      this.display();
    })).addButton((btn) => btn.setButtonText("ğŸ“Š Xem Chi Tiáº¿t").onClick(() => {
      new RewardInfoModal(this.app, this.plugin).open();
    }));
    new import_obsidian.Setting(containerEl).setName("ğŸ”” Hiá»ƒn thá»‹ thÃ´ng bÃ¡o level up").setDesc("Hiá»ƒn thá»‹ thÃ´ng bÃ¡o Ä‘áº·c biá»‡t khi Ä‘áº¡t level trÃ²n chá»¥c (10, 20, 100, ...)").addToggle((toggle) => toggle.setValue(this.plugin.settings.showNotifications).onChange(async (value) => {
      this.plugin.settings.showNotifications = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("ğŸ“ˆ Há»‡ sá»‘ XP Review").setDesc("Há»‡ sá»‘ nhÃ¢n cho XP khi xem/sá»­a ghi chÃº cÅ© (khuyáº¿n khÃ­ch review)").addSlider((slider) => slider.setLimits(1, 5, 0.5).setValue(this.plugin.settings.reviewXPMultiplier).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.reviewXPMultiplier = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "ğŸ”§ Debug/Test Tools" });
    new import_obsidian.Setting(containerEl).setName("ğŸ§ª Debug Notifications").setDesc("CÃ´ng cá»¥ test vÃ  debug thÃ´ng bÃ¡o").addButton((btn) => btn.setButtonText("ğŸ› ï¸ Open Debug Tools").onClick(() => {
      new DebugNotificationModal(this.app, this.plugin).open();
    }));
    containerEl.createEl("h3", { text: "ğŸ¨ TÃ¹y Chá»‰nh Level Messages & HÃ¬nh áº¢nh" });
    const levelContainer = containerEl.createDiv();
    this.displayCustomLevels(levelContainer);
    new import_obsidian.Setting(containerEl).addButton((btn) => btn.setButtonText("â• ThÃªm Custom Level").onClick(() => {
      new CustomLevelModal(this.app, this.plugin, () => {
        this.display();
      }).open();
    }));
    containerEl.createEl("h3", { text: "ğŸ“… NgÃ y Äáº·c Biá»‡t" });
    const datesContainer = containerEl.createDiv();
    this.displaySpecialDates(datesContainer);
    new import_obsidian.Setting(containerEl).addButton((btn) => btn.setButtonText("â• ThÃªm NgÃ y Äáº·c Biá»‡t").onClick(() => {
      new SpecialDateEditModal(this.app, this.plugin, () => {
        this.display();
      }).open();
    }));
    containerEl.createEl("hr");
    const infoDiv = containerEl.createDiv({ cls: "reward-hub-info" });
    infoDiv.innerHTML = `
            <h4>ğŸ“‹ ThÃ´ng Tin Plugin</h4>
            <p><strong>Plugin:</strong> Obsidian Reward Hub v1.0.0</p>
            <p><strong>TÃ¡c giáº£:</strong> sonct</p>
            <p><strong>MÃ´ táº£:</strong> Há»‡ thá»‘ng gamification cho Obsidian vá»›i XP, levels vÃ  thÃ´ng bÃ¡o ngÃ y Ä‘áº·c biá»‡t</p>
        `;
  }
  displayCustomLevels(container) {
    container.empty();
    const entries = Object.entries(this.plugin.settings.customLevelMessages);
    if (entries.length === 0) {
      container.createEl("p", { text: "ChÆ°a cÃ³ custom level nÃ o. HÃ£y thÃªm Ä‘á»ƒ tÃ¹y chá»‰nh thÃ´ng bÃ¡o!", cls: "setting-item-description" });
      return;
    }
    entries.forEach(([level, message]) => {
      const levelNum = parseInt(level);
      const setting = new import_obsidian.Setting(container).setName(`ğŸ† Level ${level}`).setDesc(message.substring(0, 50) + (message.length > 50 ? "..." : "")).addButton((btn) => btn.setButtonText("âœï¸").setTooltip("Sá»­a").onClick(() => {
        new CustomLevelModal(this.app, this.plugin, () => {
          this.display();
        }, levelNum).open();
      })).addButton((btn) => btn.setButtonText("ğŸ—‘ï¸").setTooltip("XÃ³a").setWarning().onClick(async () => {
        delete this.plugin.settings.customLevelMessages[levelNum];
        delete this.plugin.settings.customLevelImages[levelNum];
        await this.plugin.saveSettings();
        new import_obsidian.Notice(`ÄÃ£ xÃ³a custom level ${level}`);
        this.display();
      }));
    });
  }
  displaySpecialDates(container) {
    container.empty();
    if (this.plugin.settings.specialDates.length === 0) {
      container.createEl("p", { text: "ChÆ°a cÃ³ ngÃ y Ä‘áº·c biá»‡t nÃ o.", cls: "setting-item-description" });
      return;
    }
    this.plugin.settings.specialDates.forEach((specialDate, index) => {
      const setting = new import_obsidian.Setting(container).setName(`ğŸ“… ${specialDate.date}`).setDesc(specialDate.message.substring(0, 50) + (specialDate.message.length > 50 ? "..." : "")).addToggle((toggle) => toggle.setValue(specialDate.enabled).setTooltip("Báº­t/táº¯t").onChange(async (value) => {
        this.plugin.settings.specialDates[index].enabled = value;
        await this.plugin.saveSettings();
      })).addButton((btn) => btn.setButtonText("âœï¸").setTooltip("Sá»­a").onClick(() => {
        new SpecialDateEditModal(this.app, this.plugin, () => {
          this.display();
        }, specialDate).open();
      })).addButton((btn) => btn.setButtonText("ğŸ—‘ï¸").setTooltip("XÃ³a").setWarning().onClick(async () => {
        this.plugin.settings.specialDates.splice(index, 1);
        await this.plugin.saveSettings();
        new import_obsidian.Notice("ÄÃ£ xÃ³a ngÃ y Ä‘áº·c biá»‡t");
        this.display();
      }));
    });
  }
}

class CustomLevelModal extends import_obsidian.Modal {
  constructor(app, plugin, onSave, editingLevel) {
    super(app);
    this.level = 10;
    this.message = "";
    this.imagePath = "";
    this.plugin = plugin;
    this.onSave = onSave;
    this.editingLevel = editingLevel;
    if (editingLevel) {
      this.level = editingLevel;
      this.message = plugin.settings.customLevelMessages[editingLevel] || "";
      this.imagePath = plugin.settings.customLevelImages[editingLevel] || "";
    }
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: this.editingLevel ? "âœï¸ Sá»­a Custom Level" : "â• ThÃªm Custom Level" });
    new import_obsidian.Setting(contentEl).setName("Level").setDesc("Sá»‘ level (pháº£i chia háº¿t cho 10 hoáº·c 100)").addText((text) => text.setValue(this.level.toString()).onChange((value) => {
      this.level = parseInt(value) || 10;
    }));
    new import_obsidian.Setting(contentEl).setName("Message").setDesc("ThÃ´ng bÃ¡o tÃ¹y chá»‰nh khi Ä‘áº¡t level nÃ y trong Reward Hub").addTextArea((text) => {
      text.setValue(this.message);
      text.inputEl.rows = 4;
      text.onChange((value) => {
        this.message = value;
      });
    });
    new import_obsidian.Setting(contentEl).setName("ÄÆ°á»ng dáº«n hÃ¬nh áº£nh").setDesc("ÄÆ°á»ng dáº«n Ä‘áº¿n file hÃ¬nh áº£nh (tÃ¹y chá»n)").addText((text) => text.setPlaceholder("https://example.com/image.jpg hoáº·c local/path/image.png").setValue(this.imagePath).onChange((value) => {
      this.imagePath = value;
    }));
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    buttonContainer.style.marginTop = "30px";
    buttonContainer.style.display = "flex";
    buttonContainer.style.gap = "10px";
    buttonContainer.style.justifyContent = "center";
    const saveBtn = buttonContainer.createEl("button", { text: "ğŸ’¾ LÆ°u", cls: "mod-cta" });
    saveBtn.addEventListener("click", async () => {
      if (this.level % 10 !== 0) {
        new import_obsidian.Notice("Level pháº£i chia háº¿t cho 10 hoáº·c 100!");
        return;
      }
      if (!this.message.trim()) {
        new import_obsidian.Notice("Vui lÃ²ng nháº­p message!");
        return;
      }
      this.plugin.settings.customLevelMessages[this.level] = this.message;
      this.plugin.settings.customLevelImages[this.level] = this.imagePath;
      await this.plugin.saveSettings();
      new import_obsidian.Notice(`ÄÃ£ lÆ°u custom level ${this.level} cho Reward Hub!`);
      this.onSave();
      this.close();
    });
    const cancelBtn = buttonContainer.createEl("button", { text: "âŒ Há»§y" });
    cancelBtn.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}

class SpecialDateEditModal extends import_obsidian.Modal {
  constructor(app, plugin, onSave, editingDate) {
    super(app);
    this.date = "";
    this.message = "";
    this.imagePath = "";
    this.enabled = true;
    this.plugin = plugin;
    this.onSave = onSave;
    this.editingDate = editingDate;
    if (editingDate) {
      this.date = editingDate.date;
      this.message = editingDate.message;
      this.imagePath = editingDate.imagePath;
      this.enabled = editingDate.enabled;
    }
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: this.editingDate ? "âœï¸ Sá»­a NgÃ y Äáº·c Biá»‡t" : "â• ThÃªm NgÃ y Äáº·c Biá»‡t" });
    new import_obsidian.Setting(contentEl).setName("NgÃ y").setDesc("NgÃ y theo Ä‘á»‹nh dáº¡ng MM-DD (VD: 12-25 cho GiÃ¡ng Sinh)").addText((text) => text.setPlaceholder("MM-DD").setValue(this.date).onChange((value) => {
      this.date = value;
    }));
    const commonDates = contentEl.createDiv({ cls: "common-dates" });
    commonDates.createEl("p", { text: "ğŸ’¡ Gá»£i Ã½ ngÃ y phá»• biáº¿n:" });
    const suggestions = [
      { date: "01-01", name: "Táº¿t DÆ°Æ¡ng Lá»‹ch" },
      { date: "02-14", name: "Valentine" },
      { date: "03-08", name: "NgÃ y Quá»‘c Táº¿ Phá»¥ Ná»¯" },
      { date: "04-30", name: "NgÃ y Giáº£i PhÃ³ng" },
      { date: "05-01", name: "NgÃ y Quá»‘c Táº¿ Lao Äá»™ng" },
      { date: "09-02", name: "Quá»‘c KhÃ¡nh Viá»‡t Nam" },
      { date: "10-20", name: "NgÃ y Phá»¥ Ná»¯ Viá»‡t Nam" },
      { date: "11-20", name: "NgÃ y NhÃ  GiÃ¡o Viá»‡t Nam" },
      { date: "12-25", name: "GiÃ¡ng Sinh" }
    ];
    suggestions.forEach((suggestion) => {
      const btn = commonDates.createEl("button", {
        text: `${suggestion.date} (${suggestion.name})`,
        cls: "suggestion-btn"
      });
      btn.style.margin = "2px";
      btn.style.padding = "4px 8px";
      btn.style.fontSize = "0.8em";
      btn.addEventListener("click", () => {
        this.date = suggestion.date;
        this.message = `ChÃºc má»«ng ${suggestion.name}! ğŸ‰`;
        this.onOpen();
      });
    });
    new import_obsidian.Setting(contentEl).setName("ThÃ´ng bÃ¡o").setDesc("ThÃ´ng bÃ¡o hiá»ƒn thá»‹ trong ngÃ y Ä‘áº·c biá»‡t nÃ y").addTextArea((text) => {
      text.setValue(this.message);
      text.inputEl.rows = 3;
      text.onChange((value) => {
        this.message = value;
      });
    });
    new import_obsidian.Setting(contentEl).setName("ÄÆ°á»ng dáº«n hÃ¬nh áº£nh").setDesc("ÄÆ°á»ng dáº«n Ä‘áº¿n file hÃ¬nh áº£nh (tÃ¹y chá»n)").addText((text) => text.setPlaceholder("https://example.com/image.jpg").setValue(this.imagePath).onChange((value) => {
      this.imagePath = value;
    }));
    new import_obsidian.Setting(contentEl).setName("KÃ­ch hoáº¡t").setDesc("Báº­t thÃ´ng bÃ¡o cho ngÃ y nÃ y").addToggle((toggle) => toggle.setValue(this.enabled).onChange((value) => {
      this.enabled = value;
    }));
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    buttonContainer.style.marginTop = "30px";
    buttonContainer.style.display = "flex";
    buttonContainer.style.gap = "10px";
    buttonContainer.style.justifyContent = "center";
    const saveBtn = buttonContainer.createEl("button", { text: "ğŸ’¾ LÆ°u", cls: "mod-cta" });
    saveBtn.addEventListener("click", async () => {
      if (!/^\d{2}-\d{2}$/.test(this.date)) {
        new import_obsidian.Notice("NgÃ y pháº£i theo Ä‘á»‹nh dáº¡ng MM-DD!");
        return;
      }
      if (!this.message.trim()) {
        new import_obsidian.Notice("Vui lÃ²ng nháº­p thÃ´ng bÃ¡o!");
        return;
      }
      const newDate = {
        id: this.editingDate?.id || Date.now().toString(),
        date: this.date,
        message: this.message,
        imagePath: this.imagePath,
        enabled: this.enabled
      };
      if (this.editingDate) {
        const index = this.plugin.settings.specialDates.findIndex((d) => d.id === this.editingDate.id);
        if (index !== -1) {
          this.plugin.settings.specialDates[index] = newDate;
        }
      } else {
        this.plugin.settings.specialDates.push(newDate);
      }
      await this.plugin.saveSettings();
      new import_obsidian.Notice("ÄÃ£ lÆ°u ngÃ y Ä‘áº·c biá»‡t cho Reward Hub!");
      this.onSave();
      this.close();
    });
    const cancelBtn = buttonContainer.createEl("button", { text: "âŒ Há»§y" });
    cancelBtn.addEventListener("click", () => this.close());
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}